# Sibdev.pro_test_task

# ТЕСТОВОЕ ЗАДАНИЕ на позицию Middle Python разработчик

# Задача
Реализовать веб-сервис на базе django + DRF, имитирующий основные компоненты системы поиска новых знакомств по жизненным приоритетам. Записи для предварительного наполнения участниками содержатся в файле participants.jsonl.

**Разработать алгоритм** определения рейтинга совместимости участников. Необходимо также прикрепить описание алгоритма: как он работает, исходя из чего принято именно такое решение. При оценке, помимо самой реализации, учитывается ход мыслей.

## Сервис должен поддерживать функции

1. Работа с API:

    1.1. Регистрация и авторизация участников по email с его подтверждением;

    1.2. Получение, создание, удаление собственных приоритетов для участников;

    1.3. Эндпоинт, возвращающий список из 20 участников, наиболее совместимых по своим жизненным приоритетам пользователем, где:

    • Рейтинг совместимости определяется в %, при его подсчете учитываются все пересекающиеся приоритеты и их веса для сопоставляемых участников;

    • В список попадают лишь участники с рейтингом совместимости с пользователем > 75%;
    
    • Каждый элемент списка содержит имя участника и % совместимости.

2. Ежедневная рассылка писем пользователям с подтвержденным email, содержащая:

    Список из 3-х предпочтений, рекомендуемых системой к заполнению. В рекомендацию попадают наиболее популярные предпочтения среди других участников, не заполненные получателем.

## Требования

1. Проект

    ◦ Запросы к БД рационально оптимизированы;

    ◦ Логика вычисления рейтинга совместимости покрыта тестами и документирована.

2. Рассылка

    ◦ Список рекомендуемых к заполнению предпочтений берется из кэшируемого пула наиболее популярных. Кэш обновляется ежедневно. 

3. Приложение должно быть контейнирезировано при помощи docker;

4. Проект не использует глобальных зависимостей за исключением: python, docker, docker-compose;

5. Readme проекта описывает весь процесс установки, запуска и работы с сервисом;

6. Требования к фронтенду не предъявляются, интерфейс взаимодействия — RestFull API.

7. Проект запускается одной командой.

## Будет плюсом

• Команда для запуска проекта - docker-compose up.

## Особое внимание при проверке уделим

• Чистоте и понятности кода;

• Архитектуре сервиса и обоснованности решений.


## Сущности проекта

1. participants.jsonl - файл, содержащий персон с заполненными приоритетами, желающих участвовать в проекте;

2. участник - пользователь системы;

3. приоритет - положительное или отрицательное отношение участника к какому-либо жизненному аспекту и степень его важности для участника (вес) по 10-балльной шкале. Пример: курение, отрицательно, 5

Рекомендуемое время выполнения тестового задания: 2-3 дня

# Разворачивание проекта
### Клонируйте репозиторий
        git clone https://github.com/KorsakovPV/Sibdev.pro_test_task

   или 

        git clone ssh://git@github.com/KorsakovPV/Sibdev.pro_test_task

   В корневой папке находим файл *.env.template*. Это шаблон файла переменных окружения. По образу и подобию необходимо создать файл *.env* и заполнить его своими значениями.

### Запускаем процесс сборки и запуска контейнеров:
      docker-compose up --build

### Применяем миграции
      docker-compose exec sibdev_api python manage.py migrate

### Создаем суперпользователя
      docker-compose exec sibdev_api python manage.py createsuperuser

### Собрать статику
      docker-compose exec sibdev_api python manage.py collectstatic

### Загружаем тестовые данный
      docker-compose exec sibdev_api python manage.py upload_initial_data (20000 записей)

   или

      docker-compose exec sibdev_api python manage.py upload_initial_data_mini (300 записей)

http://127.0.0.1/ (Режим дебаг не отключен)

http://127.0.0.1/admin/ Админка

http://127.0.0.1/docs/ Документация ReDoc

http://127.0.0.1/swagger/ Документация Swagger

http://127.0.0.1/accounts/send_confirmation_email/ Подтверждение email. Зарегистрироваться в системе не подтвердив пароль невозможно. Для отправки письма использован файловый бэкэнд *django.core.mail.backends.filebased.EmailBackend*. Все письма сохраняются в папке **temp-mail**. Код подтверждения пароля предлагаю посмотреть в админке в EmailConfirmation.

http://127.0.0.1/accounts/register/ Регистрация.

http://127.0.0.1/token/ Регистрация. Получение token. 

http://127.0.0.1/priorities_name/ Добавление удаление и редактирование названий приоритетов. Безопасные методы доступны всем пользователям. Потенциально опасные доступны только аутентифицированным пользователям. Приоритеты имеющие одну и более связей с аккаунтом защищены от удаления, но не от редактирования аутентифицированными пользователями.

http://127.0.0.1/priorities/ Добавление удаление и редактирование приоритетов аутентифицированных пользователей.

http://127.0.0.1/priorities/compatibility_list/ Получение списка подходящих аккаунтов.

